{"ast":null,"code":"import axios from 'axios';\naxios.defaults.withCredentials = true;\nexport const types = {\n  LOGIN: 'AUTH/LOGIN',\n  LOGOUT: 'AUTH/LOGOUT'\n};\nconst initialState = {\n  userId: null,\n  username: null,\n  user_function: 9\n};\nexport const actions = {\n  login: obj => {\n    return dispatch => {\n      let resuser_function, resusername;\n      axios.post('http://127.0.0.1/api/login', {\n        username: obj.username,\n        password: obj.password\n      }).then(function (res) {\n        resusername = res.data[0]['user_name'];\n        resuser_function = res.data[0]['user_function'];\n        console.log(resusername, resuser_function);\n        dispatch({\n          type: types.LOGIN,\n          username: resusername,\n          user_function: resuser_function\n        });\n      }).catch(function (err) {\n        console.log(err);\n        alert('登陆失败！');\n        dispatch({\n          type: types.LOGINFAIL\n        });\n      });\n    };\n  },\n  logout: () => {\n    axios.get('http://127.0.0.1/api/logout').then(function (response) {\n      console.log(response);\n    }).catch(function (error) {\n      console.log(error);\n    });\n    return {\n      type: types.LOGOUT\n    };\n  }\n};\n\nconst reducer = (state = initialState, action) => {\n  switch (action.type) {\n    case types.LOGIN:\n      return { ...state,\n        username: action.username,\n        user_function: action['user_function']\n      };\n\n    case types.LOGOUT:\n      return { ...state,\n        username: null,\n        userId: null,\n        user_function: 9\n      };\n\n    default:\n      return state;\n  }\n};\n\nexport default reducer;\nexport const getUsername = state => {\n  switch (state.username) {\n    case 'daidai':\n      return '呆呆';\n\n    case 'guaiguai':\n      return '乖乖';\n\n    default:\n      return state.username;\n  }\n};","map":{"version":3,"sources":["C:/Users/何亚星/Desktop/myWeb/client/src/redux/auth.js"],"names":["axios","defaults","withCredentials","types","LOGIN","LOGOUT","initialState","userId","username","user_function","actions","login","obj","dispatch","resuser_function","resusername","post","password","then","res","data","console","log","type","catch","err","alert","LOGINFAIL","logout","get","response","error","reducer","state","action","getUsername"],"mappings":"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","sourcesContent":["import axios from 'axios'\r\naxios.defaults.withCredentials = true\r\n\r\nexport const types = {\r\n  LOGIN: 'AUTH/LOGIN',\r\n  LOGOUT: 'AUTH/LOGOUT'\r\n}\r\n\r\nconst initialState = {\r\n  userId: null,\r\n  username: null,\r\n  user_function: 9\r\n}\r\n\r\nexport const actions = {\r\n  login: obj => {\r\n    return dispatch => {\r\n      let resuser_function, resusername\r\n      axios\r\n        .post('http://127.0.0.1/api/login', {\r\n          username: obj.username,\r\n          password: obj.password\r\n        })\r\n        .then(function(res) {\r\n          resusername = res.data[0]['user_name']\r\n          resuser_function = res.data[0]['user_function']\r\n          console.log(resusername, resuser_function)\r\n          dispatch({\r\n            type: types.LOGIN,\r\n            username: resusername,\r\n            user_function: resuser_function\r\n          })\r\n        })\r\n        .catch(function(err) {\r\n          console.log(err)\r\n          alert('登陆失败！')\r\n          dispatch({ type: types.LOGINFAIL })\r\n        })\r\n    }\r\n  },\r\n  logout: () => {\r\n    axios\r\n      .get('http://127.0.0.1/api/logout')\r\n      .then(function(response) {\r\n        console.log(response)\r\n      })\r\n      .catch(function(error) {\r\n        console.log(error)\r\n      })\r\n    return {\r\n      type: types.LOGOUT\r\n    }\r\n  }\r\n}\r\n\r\nconst reducer = (state = initialState, action) => {\r\n  switch (action.type) {\r\n    case types.LOGIN:\r\n      return {\r\n        ...state,\r\n        username: action.username,\r\n        user_function: action['user_function']\r\n      }\r\n    case types.LOGOUT:\r\n      return {\r\n        ...state,\r\n        username: null,\r\n        userId: null,\r\n        user_function: 9\r\n      }\r\n    default:\r\n      return state\r\n  }\r\n}\r\n\r\nexport default reducer\r\n\r\nexport const getUsername = state => {\r\n  switch (state.username) {\r\n    case 'daidai':\r\n      return '呆呆'\r\n    case 'guaiguai':\r\n      return '乖乖'\r\n    default:\r\n      return state.username\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}