{"ast":null,"code":"import axios from 'axios';\naxios.defaults.withCredentials = true;\nexport const types = {\n  LOGIN: 'AUTH/LOGIN',\n  LOGOUT: 'AUTH/LOGOUT',\n  LOGINFAIL: 'AUTH/LOGINFAIL',\n  LOADING: 'AUTH/LOADING'\n};\nconst initialState = {\n  userId: null,\n  username: null,\n  user_function: 9,\n  login_fail: 'false'\n};\nexport const actions = {\n  login: obj => {\n    return dispatch => {\n      dispatch({\n        type: types.LOADING\n      });\n      let resuser_function, resusername;\n      axios.post('http://127.0.0.1/api/login', {\n        username: obj.username,\n        password: obj.password\n      }).then(function (res) {\n        resusername = res.data[0]['user_name'];\n        resuser_function = res.data[0]['user_function'];\n        console.log(resusername, resuser_function);\n        dispatch({\n          type: types.LOGIN,\n          username: resusername,\n          user_function: resuser_function\n        });\n      }).catch(function (err) {\n        console.log(err);\n        alert('登陆失败！');\n        dispatch({\n          type: types.LOGINFAIL\n        });\n      });\n    };\n  },\n  logout: () => {\n    axios.get('http://127.0.0.1/api/logout').then(function (response) {\n      console.log(response);\n    }).catch(function (error) {\n      console.log(error);\n    });\n    return {\n      type: types.LOGOUT\n    };\n  }\n};\n\nconst reducer = (state = initialState, action) => {\n  switch (action.type) {\n    case types.LOGIN:\n      return { ...state,\n        username: action.username,\n        user_function: action['user_function'],\n        login_fail: false\n      };\n\n    case types.LOGOUT:\n      return { ...state,\n        username: null,\n        userId: null,\n        user_function: 9\n      };\n\n    case types.LOGINFAIL:\n      return { ...state,\n        login_fail: true\n      };\n\n    default:\n      return state;\n  }\n};\n\nexport default reducer;\nexport const getUsername = state => {\n  switch (state.username) {\n    case 'daidai':\n      return '呆呆';\n\n    case 'guaiguai':\n      return '乖乖';\n\n    default:\n      return state.username ? '游客' : null;\n  }\n};","map":{"version":3,"sources":["C:/Users/何亚星/Desktop/myWeb/client/src/redux/auth.js"],"names":["axios","defaults","withCredentials","types","LOGIN","LOGOUT","LOGINFAIL","LOADING","initialState","userId","username","user_function","login_fail","actions","login","obj","dispatch","type","resuser_function","resusername","post","password","then","res","data","console","log","catch","err","alert","logout","get","response","error","reducer","state","action","getUsername"],"mappings":"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","sourcesContent":["import axios from 'axios'\r\naxios.defaults.withCredentials = true\r\n\r\nexport const types = {\r\n  LOGIN: 'AUTH/LOGIN',\r\n  LOGOUT: 'AUTH/LOGOUT',\r\n  LOGINFAIL: 'AUTH/LOGINFAIL',\r\n  LOADING: 'AUTH/LOADING'\r\n}\r\n\r\nconst initialState = {\r\n  userId: null,\r\n  username: null,\r\n  user_function: 9,\r\n  login_fail: 'false'\r\n}\r\n\r\nexport const actions = {\r\n  login: obj => {\r\n    return dispatch => {\r\n      dispatch({ type: types.LOADING })\r\n      let resuser_function, resusername\r\n      axios\r\n        .post('http://127.0.0.1/api/login', {\r\n          username: obj.username,\r\n          password: obj.password\r\n        })\r\n        .then(function(res) {\r\n          resusername = res.data[0]['user_name']\r\n          resuser_function = res.data[0]['user_function']\r\n          console.log(resusername, resuser_function)\r\n          dispatch({\r\n            type: types.LOGIN,\r\n            username: resusername,\r\n            user_function: resuser_function\r\n          })\r\n        })\r\n        .catch(function(err) {\r\n          console.log(err)\r\n          alert('登陆失败！')\r\n          dispatch({ type: types.LOGINFAIL })\r\n        })\r\n    }\r\n  },\r\n  logout: () => {\r\n    axios\r\n      .get('http://127.0.0.1/api/logout')\r\n      .then(function(response) {\r\n        console.log(response)\r\n      })\r\n      .catch(function(error) {\r\n        console.log(error)\r\n      })\r\n    return {\r\n      type: types.LOGOUT\r\n    }\r\n  }\r\n}\r\n\r\nconst reducer = (state = initialState, action) => {\r\n  switch (action.type) {\r\n    case types.LOGIN:\r\n      return {\r\n        ...state,\r\n        username: action.username,\r\n        user_function: action['user_function'],\r\n        login_fail: false\r\n      }\r\n    case types.LOGOUT:\r\n      return {\r\n        ...state,\r\n        username: null,\r\n        userId: null,\r\n        user_function: 9\r\n      }\r\n    case types.LOGINFAIL:\r\n      return {\r\n        ...state,\r\n        login_fail: true\r\n      }\r\n    default:\r\n      return state\r\n  }\r\n}\r\n\r\nexport default reducer\r\n\r\nexport const getUsername = state => {\r\n  switch (state.username) {\r\n    case 'daidai':\r\n      return '呆呆'\r\n    case 'guaiguai':\r\n      return '乖乖'\r\n    default:\r\n      return state.username ? '游客' : null\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}